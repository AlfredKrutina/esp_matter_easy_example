# Kompletn√≠ Seznam Knihoven a Managed Components

## üéØ OBSAH
1. Syst√©mov√© p≈ôedpoklady
2. ESP-IDF Setup
3. ESP-Matter Setup
4. Managed Components (automaticky stahov√°ny)
5. P≈ô√≠kazy pro instalaci
6. Verifikace instalace
7. Troubleshooting

---

## 1. SYST√âMOV√â P≈òEDPOKLADY

### Linux (Ubuntu 20.04/22.04)
```bash
sudo apt-get install git gcc g++ pkg-config libssl-dev libdbus-1-dev \
    libglib2.0-dev libavahi-client-dev ninja-build python3-venv python3-dev \
    python3-pip unzip libgirepository1.0-dev libcairo2-dev libreadline-dev
```

### macOS
```bash
brew install gcc g++ pkg-config openssl dbus glib avahi libffi cairo python3
```

---

## 2. ESP-IDF SETUP (V√ùCHOZ√ç)

### Verze: 5.2.x nebo 5.3.x (doporuƒçeno pro ESP32-C6)

```bash
# Klonovat ESP-IDF
git clone --recursive https://github.com/espressif/esp-idf.git
cd esp-idf

# Nastavit na konkr√©tn√≠ verzi (doporuƒçeno v5.2.2)
git checkout v5.2.2
git submodule update --init --recursive

# Instalace
./install.sh

# Nastavit environment (poka≈æd√© v nov√©m termin√°lu)
cd esp-idf
source ./export.sh
cd ..
```

---

## 3. ESP-MATTER SETUP (KL√çƒåOV√â PRO PROJEKT)

### Volba A: Pln√° instalace (doporuƒçena)

```bash
# Klonovat esp-matter s submoduly
git clone --depth 1 https://github.com/espressif/esp-matter.git
cd esp-matter

# Inicializovat submoduly
git submodule update --init --depth 1

# Pro Matter device n√°stroj≈Ø
cd ./connectedhomeip/connectedhomeip
./scripts/checkout_submodules.py --platform esp32 linux --shallow
cd ../..

# Instalace esp-matter (obsahuje v≈°echny pot≈ôebn√© kompil√°tory)
./install.sh

# Nastavit environment (poka≈æd√© v nov√©m termin√°lu)
cd esp-matter
source ./export.sh
cd ..
```

### Volba B: Managed Component (experimental - pro jednoduch√Ω projekt)

Pokud m√°te POUZE egyszer projekt bez Matter n√°stroj≈Ø:
```bash
cd /path/to/your/project
idf.py add-dependency "espressif/esp_matter^1.4.0"
```

---

## 4. MANAGED COMPONENTS (AUTOMATICKY STAHOV√ÅNY)

Tyto komponenty se automaticky stahuj√≠ bƒõhem `idf.py build` kdy≈æ je projekt spr√°vnƒõ nakonfigurov√°n.

### Prim√°rn√≠ komponenty pro VA≈† projekt:

| Komponenta | Verze | √öƒçel |
|-----------|-------|------|
| **esp-matter** | 1.4.0+ | Matter framework a protokol |
| **led_strip** | 2.5.x+ | RMT driver pro WS2812B LED |
| **esp_common** | - | Z√°kladn√≠ ESP komponenty |
| **nvs_flash** | - | Non-volatile storage (Matter data) |

### Vedlej≈°√≠ komponenty (automaticky):

| Komponenta | √öƒçel |
|-----------|------|
| **cbor** | Serialization pro Matter |
| **esp_diagnostics** | Diagnostika a logov√°n√≠ |
| **esp_diag_data_store** | Ukl√°d√°n√≠ diagnostick√Ωch dat |
| **button** | GPIO handle (optional) |

---

## 5. P≈ò√çKAZY PRO INSTALACI - KROK ZA KROKEM

### Krok 1: Instalace z√°kladu (jednou)

```bash
# Domovsk√Ω adres√°≈ô
mkdir -p ~/esp
cd ~/esp

# ESP-IDF
git clone --recursive https://github.com/espressif/esp-idf.git
cd esp-idf
git checkout v5.2.2
./install.sh
source ./export.sh
cd ..

# ESP-Matter
git clone --depth 1 https://github.com/espressif/esp-matter.git
cd esp-matter
git submodule update --init --depth 1
cd ./connectedhomeip/connectedhomeip
./scripts/checkout_submodules.py --platform esp32 linux --shallow
cd ../..
./install.sh
source ./export.sh
cd ..
```

### Krok 2: P≈ô√≠prava nov√©ho projektu

```bash
# Vytvo≈ôit adres√°≈ô projektu
mkdir -p ~/projects/matter-light-esp32c6
cd ~/projects/matter-light-esp32c6

# Nastavit ESP-IDF
cd ~/esp/esp-idf
source ./export.sh
cd ~/projects/matter-light-esp32c6

# Nastavit ESP-Matter
cd ~/esp/esp-matter
source ./export.sh
cd ~/projects/matter-light-esp32c6
```

### Krok 3: Kop√≠rovat moje poskytovan√© soubory do projektu

```bash
# Struktura:
matter-light-esp32c6/
‚îú‚îÄ‚îÄ CMakeLists.txt
‚îú‚îÄ‚îÄ main/
‚îÇ   ‚îú‚îÄ‚îÄ CMakeLists.txt
‚îÇ   ‚îú‚îÄ‚îÄ main.c
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ led_driver/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CMakeLists.txt
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ include/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ led_driver.h
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ led_driver.c
‚îÇ   ‚îî‚îÄ‚îÄ matter_config/
‚îÇ       ‚îú‚îÄ‚îÄ CMakeLists.txt
‚îÇ       ‚îî‚îÄ‚îÄ matter_config.h
‚îú‚îÄ‚îÄ sdkconfig.defaults
‚îî‚îÄ‚îÄ partitions.csv
```

### Krok 4: Stahnout managed components a buildovat

```bash
cd ~/projects/matter-light-esp32c6

# Nastavit c√≠lov√Ω chip
idf.py set-target esp32c6

# Vytvo≈ôen√≠ idf_component.yml (pro managed components)
idf.py create-manifest

# Reconfigurovat projekt (st√°hne managed components)
idf.py reconfigure

# Ovƒõ≈ôit, ≈æe se st√°hly komponenty
ls -la managed_components/

# Konfigurovat projekt
idf.py menuconfig
# ‚Üí Example Configuration ‚Üí Set YOUR_SSID, YOUR_PASSWORD

# Build
idf.py build

# Flash
idf.py -p /dev/ttyUSB0 flash monitor
```

---

## 6. OVƒö≈òEN√ç INSTALACE

### Kontrola ESP-IDF
```bash
cd ~/esp/esp-idf
source ./export.sh
idf.py --version
# Mƒõl by vypsat: ESP-IDF v5.2.2
```

### Kontrola ESP-Matter
```bash
cd ~/esp/esp-matter
source ./export.sh
which idf.py
# Mƒõl by vypsat cestu k esp-matter/tools/idf.py
```

### Kontrola managed components
```bash
cd ~/projects/matter-light-esp32c6
idf.py build 2>&1 | grep -i "Processing.*dependencies"
# Mƒõl by vypsat seznam stahovan√Ωch komponent
```

### Kontrola LED knihovny
```bash
find ~/esp/esp-idf -name "led_strip.h" | head -1
# Mƒõl by vypsat: /path/to/esp-idf/components/led_strip/include/led_strip.h
```

---

## 7. ENVIRONMENT SETUP SCRIPT (DOPORUƒåENO)

Vytvo≈ôit soubor `~/.bashrc` nebo `~/.zshrc`:

```bash
# Matter Development Environment
export ESP_HOME="$HOME/esp"

get_matter() {
    cd "$ESP_HOME/esp-idf"
    source ./export.sh
    cd "$ESP_HOME/esp-matter"
    source ./export.sh
    echo "‚úì Matter environment ready"
}

# Alternativnƒõ: automatick√© nastaven√≠
if [ -f "$ESP_HOME/esp-idf/export.sh" ]; then
    . "$ESP_HOME/esp-idf/export.sh" > /dev/null 2>&1
fi
if [ -f "$ESP_HOME/esp-matter/export.sh" ]; then
    . "$ESP_HOME/esp-matter/export.sh" > /dev/null 2>&1
fi
```

Pak v termin√°lu:
```bash
source ~/.bashrc
# nebo
source ~/.zshrc
```

---

## 8. PROBL√âMOV√â ≈òE≈†EN√ç

### Probl√©m: "espressif/esp_matter not found"
**≈òe≈°en√≠**: Ujistit se, ≈æe m√°te ESP-Matter repository, ne jen komponentu
```bash
cd ~/esp/esp-matter
git status  # Mƒõl by vypsat Matter repo, ne managed component
```

### Probl√©m: "led_strip.h: No such file"
**≈òe≈°en√≠**: Komponenta led_strip nen√≠ automaticky sta≈æena
```bash
idf.py add-dependency "espressif/led_strip"
idf.py reconfigure
```

### Probl√©m: "CMake version 3.5 or higher required"
**≈òe≈°en√≠**: Aktualizovat CMake
```bash
pip install --upgrade cmake
```

### Probl√©m: "CHIP not found" bƒõhem build
**≈òe≈°en√≠**: esp-matter instalace neprobƒõhla spr√°vnƒõ
```bash
cd ~/esp/esp-matter
./install.sh --no-host-tool  # Rychlej≈°√≠ varianta
```

### Probl√©m: "GCC ARM version mismatch"
**≈òe≈°en√≠**: P≈ôeinstalovat toolchain
```bash
cd ~/esp/esp-idf
./install.sh --reinstall
```

---

## 9. QUICK START (PRO ZKU≈†EN√â)

```bash
# Setup (jednou)
cd ~/esp
git clone --recursive https://github.com/espressif/esp-idf.git
cd esp-idf && git checkout v5.2.2 && ./install.sh
cd ..
git clone --depth 1 https://github.com/espressif/esp-matter.git
cd esp-matter && git submodule update --init --depth 1
cd ./connectedhomeip/connectedhomeip
./scripts/checkout_submodules.py --platform esp32 linux --shallow
cd ../.. && ./install.sh

# Project (poka≈æd√©)
cd ~/esp/esp-idf && source ./export.sh
cd ~/esp/esp-matter && source ./export.sh
cd ~/projects/matter-light-esp32c6
idf.py set-target esp32c6
idf.py build
idf.py -p /dev/ttyUSB0 flash monitor
```

---

## 10. P≈ò√çLOHA: MANAGED COMPONENTS MANU√ÅLN√ç INSTALACE

Pokud `idf.py build` sel≈æe na chybƒõj√≠c√≠ch komponent√°ch, instalujte ruƒçnƒõ:

```bash
cd ~/projects/matter-light-esp32c6

# LED Strip
idf.py add-dependency "espressif/led_strip"

# CBOR (pro Matter serialization)
idf.py add-dependency "espressif/cbor"

# Matter (pokud nen√≠ v esp-matter)
idf.py add-dependency "espressif/esp_matter^1.4.0"

# Update dependencies
idf.py update-dependencies

# Reconfigure
idf.py reconfigure
```

Po tom by mƒõl b√Ωt seznam v `dependencies.lock`:

```
espressif/led_strip: 2.5.x
espressif/cbor: 0.6.0~1
espressif/esp_matter: 1.4.0+
```

---

## 11. OVƒö≈òEN√ç FIN√ÅLN√ç FUNKƒåNOSTI

```bash
# 1. P≈ôej√≠t na projekt
cd ~/projects/matter-light-esp32c6

# 2. Clean build
rm -rf build/ dependencies.lock managed_components/
idf.py fullclean

# 3. Reconfigure
idf.py set-target esp32c6
idf.py reconfigure

# 4. Ovƒõ≈ôit managed components
ls -la managed_components/
# Mƒõl by vypsat: led_strip/, cbor/, esp_matter/

# 5. Build s verbosn√≠m loggingem
idf.py build 2>&1 | tee build.log

# 6. Ovƒõ≈ôit linking
grep -i "error" build.log | grep -i "led_strip\|matter\|cbor"
# Pokud nic nen√≠ vyps√°no ‚Üí ‚úì OK

# 7. Flash a test
idf.py -p /dev/ttyUSB0 flash monitor
```

Pokud vid√≠te v logu:
```
I (xxx) LED_DRIVER: LED driver inicializov√°n
I (xxx) APP: Matter node vytvo≈ôen
I (xxx) APP: WiFi inicializov√°no
```

‚Üí **‚úì V≈†E FUNGUJE!**
